name: "linear_regression"

task:
  _target_: tasks.meta_optimizer.MetaOptimizerForRegression
  meta_objective: prequential
  min_train_samples: 1
  lr: 1e-4
  context_aggregator:
    _target_: models.context_aggregator.Transfoptimizer
    x_dim: ${ast_eval:'${experiment.dataset.train_dataset.x_dim} + ${experiment.dataset.train_dataset.y_dim}'}
    z_dim: 128
    h_dim: 256
    n_layers: 4
    n_heads: 4
  predictor:
    _target_: models.predictor.MLPConcatPredictor
    x_dim: ${experiment.dataset.train_dataset.x_dim}
    z_dim: ${experiment.task.context_aggregator.z_dim}
    y_dim: ${experiment.dataset.train_dataset.y_dim}
    h_dim: 256
    n_layers: 5

dataset:
  _target_: datasets.interfaces.ICLDataModule
  batch_size: 256
  train_dataset:
    _target_: datasets.regression.LinearRegression
    x_dim: 1
    y_dim: 1
    n_tasks: 10000
    n_samples: 50
    noise: 0.0
    data_dist: "normal"
    shuffle_samples: True
  val_dataset:
    _target_: datasets.regression.LinearRegression
    x_dim: ${experiment.dataset.train_dataset.x_dim}
    y_dim: ${experiment.dataset.train_dataset.y_dim}
    n_tasks: 1000
    n_samples: ${experiment.dataset.train_dataset.n_samples}
    noise: 0.0
    data_dist: ${experiment.dataset.train_dataset.data_dist}
    shuffle_samples: ${experiment.dataset.train_dataset.shuffle_samples}

trainer:
  max_epochs: 1000

callbacks:
